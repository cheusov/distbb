#-*-mode:  sh -*-

PKGSRC_PREFIX=/home/cheusov/pkg
BMAKE=$PKGSRC_PREFIX/bin/bmake
PKGSRCDIR=/srv/pkgsrc_current
RMDIRS_CMD="/bin/rm -rf $PKGSRC_PREFIX /var/db/pkg"
BOOTSTRAP="/srv/pkgsrc_distfiles/bootstrap-unpriv.tar.gz"
EXTRACT_BOOTSTRAP_CMD="/bin/tar -xf $BOOTSTRAP -C /"
MASTER_MODE=yes
SLAVES='root@host1 root@host2 root@host3'
REPORTS_DIR=$HOME/bulk-logs
TARGETS='dbb_init clean dbb_canbebuilt dbb_excluded dbb_vars depends fetch checksum extract patch configure build install package deinstall'
NOTES=/path/to/my_notes.txt

assign SPECIAL_PACKAGES "\
PKGPATH=pkgtools/bootstrap-mk-files
TARGETS=dbb_init clean dbb_vars depends fetch checksum extract patch configure build package
EXTRA_OPTS=BATCH=yes PKG_VERBOSE=1 USE_DESTDIR=full CHECK_SHLIBS=no

PKGPATH=devel/bmake
TARGETS=dbb_init clean dbb_vars depends fetch checksum extract patch configure build package
EXTRA_OPTS=BATCH=yes PKG_VERBOSE=1 USE_DESTDIR=full CHECK_SHLIBS=no

PKGPATH=pkgtools/pkg_install
TARGETS=dbb_init clean dbb_vars depends fetch checksum extract patch configure build package
EXTRA_OPTS=BATCH=yes PKG_VERBOSE=1 USE_DESTDIR=full CHECK_SHLIBS=no

"

USER_ADDRESS=vasya@pupkin.com

UPLOAD_PKGS_CMD="@@bindir@@/rsync -av --delete-excluded -e ssh $PACKAGES/ cheusov@mova.org:~/public_html/pub/pkgsrc-distbb/$OS/$PKGSRCVER/packages/"
UPLOAD_LOGS_CMD="@@bindir@@/rsync -av --delete-excluded --exclude \"*.tmp\" -e ssh $REPORTS_DIR/$BUILD_ID cheusov@mova.org:~/public_html/pub/pkgsrc-distbb/$OS/$PKGSRCVER/logs/"

# define your post-build actions in this function
post_build (){
    pkg_refresh_summary "${PKG_SUMMARY}" | gzip  > "${PKG_SUMMARY%.txt}.gz"
    pkg_refresh_summary "${PKG_SUMMARY}" | bzip2 > "${PKG_SUMMARY%.txt}.bz2"
}

######################################################################
I_AM_READY=4

. @@datadir@@/distbb.default.conf
