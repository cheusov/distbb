#!/bin/sh

set -e
. pipestatus

######################################################################

header (){
    printf ' --**--**-- %8s --**--**--\n' "$1"
}

######################################################################

usage (){
    cat <<EOF
usage: distbb_slave node
EOF
}

if test $# -ne 2; then
    usage
    exit 1
fi

node=$1
fake_cmd=$2
shift
shift

build_package (){
    header build
    echo "building $pkgpath...done"
}

if test -z $queue_fn; then
    exit 2
fi

while read pkgpath; do
#    echo "package: $pkgpath" 1>&2
    echo "package: $pkgpath"
    if runpipe_re '. 0' build_package '|' uuencode -; then
	echo "status: $pipestatus_1"
    else
	echo "status: 1" # uuencode failed
    fi
    echo ''
done
