#!/bin/sh

#
# run 'make depends' with changed DEPENDS and BUILD_DEPENDS.
# Alternative dependencies are removed.
#

# $1 - enriched pkgpath

set -e

export PATH=@@bindir@@:$PATH

test -n "$PKG_ADD"
test -n "$PACKAGES"
test -n "$aux_full_deps_fn"
test -n "$aux_pkg_src_summary_fn"

test $# -eq 1

get_deps (){
    @@libexecdir@@/get_direct_pkgname_deps "$1" \
	"$aux_full_deps_fn" \
	"$aux_pkg_src_summary_fn"
}

export PKG_PATH="${PACKAGES}/All"

for p in `get_deps $1`; do
    $PKG_ADD -u "$PACKAGES/All/$p"
done
